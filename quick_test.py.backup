#!/usr/bin/env python3
"""
Quick deployment test - å•é¡Œç‰¹å®šç”¨
"""

print("ğŸ” å•é¡Œè¨ºæ–­é–‹å§‹...")

# 1. PythonåŸºæœ¬å‹•ä½œç¢ºèª
try:
    import sys
    print(f"âœ… Python version: {sys.version}")
except Exception as e:
    print(f"âŒ PythonåŸºæœ¬å‹•ä½œã‚¨ãƒ©ãƒ¼: {e}")

# 2. å¿…è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç¢ºèª
required_packages = ['fastapi', 'uvicorn', 'pydantic']
for package in required_packages:
    try:
        __import__(package)
        print(f"âœ… {package} - OK")
    except ImportError as e:
        print(f"âŒ {package} - æœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: {e}")

# 3. ãƒãƒ¼ãƒˆç¢ºèª
import socket
ports_to_check = [8001, 8002, 8003, 8004, 8005, 8006]
for port in ports_to_check:
    try:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
            s.bind(('localhost', port))
            print(f"âœ… ãƒãƒ¼ãƒˆ {port} - åˆ©ç”¨å¯èƒ½")
    except OSError:
        print(f"âš ï¸ ãƒãƒ¼ãƒˆ {port} - ä½¿ç”¨ä¸­")

# 4. ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª
import os
critical_files = [
    'services/core-game/main.py',
    'services/auth/main.py', 
    'services/task-mgmt/main.py'
]

for file_path in critical_files:
    if os.path.exists(file_path):
        print(f"âœ… {file_path} - å­˜åœ¨")
        
        # UNICODEæ–‡å­—ãƒã‚§ãƒƒã‚¯
        try:
            with open(file_path, 'r', encoding='utf-8') as f:
                content = f.read()
                if '[UNICODE_' in content:
                    print(f"âš ï¸ {file_path} - UNICODEæ–‡å­—å•é¡Œã‚ã‚Š")
                else:
                    print(f"âœ… {file_path} - ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°OK")
        except Exception as e:
            print(f"âŒ {file_path} - èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {e}")
    else:
        print(f"âŒ {file_path} - è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")

print("\nğŸ¯ è¨ºæ–­å®Œäº†")
print("\nğŸ’¡ æ¨å¥¨è§£æ±ºç­–:")
print("1. UNICODEæ–‡å­—ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£")
print("2. ä½¿ç”¨ä¸­ã®ãƒãƒ¼ãƒˆã‚’è§£æ”¾")
print("3. ä¾å­˜é–¢ä¿‚ã‚’å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«")